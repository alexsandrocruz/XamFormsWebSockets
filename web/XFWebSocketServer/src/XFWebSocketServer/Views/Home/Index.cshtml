@{
    ViewData["Title"] = "Home Page";
}


<div class="row">
    <div class="col-md-6">
        <h2>Web Sockets with Xamarin Forms!</h2>
        <form>
            <div class="form-group">
                <label for="message">Message:</label>
                <textarea id="message" class="form-control" rows="3"></textarea>
            </div>
            <button class="btn btn-default">Send</button>
        </form>
    </div>
    <div class="col-md-6">

    </div>

</div>

@section scripts{

    <script>
        var webSocket;
        $().ready(function () {
            webSocket = new WebSocket("ws://localhost:53273/");
            webSocket.onopen = function () {
                $("#spanStatus").text("connected");
            };
            webSocket.onmessage = function (evt) {
                $("#spanStatus").text(evt.data);
            };
            webSocket.onerror = function (evt) {
                alert(evt.message);
            };
            webSocket.onclose = function () {
                $("#spanStatus").text("disconnected");
            };
            $("#btnSend").click(function () {
                if (webSocket.readyState == WebSocket.OPEN) {
                    webSocket.send($("#textInput").val());
                }
                else {
                    $("#spanStatus").text("Connection is closed");
                }
            });
        });

    </script>

}
